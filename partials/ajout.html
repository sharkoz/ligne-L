<div class="cardswidth" ng-cloak>
<!--
    <div class="metacard" ng-controller="TrajetModif">
        <div class="">
            <div class="card front">
                    <div class="jelly-form" style="margin-top:0;">
                        <div style="position: relative;"> 
							<paper-input  label="Gare de départ" ng-model="autoDepart"></paper-input>
                            <a style="position: absolute; cursor: pointer; font-size: 1em; top: 2px; right: 5px;" ng-show="autoShow" tabindex="-1" ng-click="autoDepart='';autoShow=0;" class="clear_button">×</a>
                        </div>
                    </div>
                    <div ng-show="autoShow">
                        <div class="autocomplete" ng-repeat="index in DepartList" ng-click="$parent.autoDepart = gare[index.codeTR3A];$parent.trajet.depart = '{{index.codeTR3A}}'; $parent.trajet.arrivee = '0';getDessertes(); $parent.trajet.depart_pos = {'latitude':'{{index.latitude}}','longitude':'{{index.longitude}}'}; trajet.savedate = '';broadcastRefresh();$parent.autoShow = 0;$parent.collapse=1">
                            <a>{{index.name}} <span><span ng-repeat="im in index.lignes" class="rer transilien ligne{{im.idLigne}}">{{im.idLigne}}</span></span></a>
                        </div>
                    </div>
                <div class="collapsible" ng-show="collapse">
                    <div ng-hide="autoShow">
                        <div class="jelly-form">
                            <label>Arrivée :</label>
                            <div>
                                <SELECT ng-show="ListeDessertes" ng-model="trajet.arrivee" ng-change="trajet.savedate = '';broadcastRefresh()">
                                    <OPTION value='0' >Toutes directions</OPTION>
                                    <OPTION ng-repeat="index in ListeDessertes | orderBy:'name'" value="{{index.codeTR3A}}" ng-selected="index.codeTR3A==trajet.arrivee">{{gare[index.codeTR3A]}}</OPTION>
                                </SELECT>
                                <div ng-hide="ListeDessertes" ng-click="getDessertes();">
                                    <span class="svg refresh spin_image" style="height:18px;width:18px;">MaJ</span> {{gare[trajet.arrivee]}}
                                </div>
                            </div>
                        </div>
                        <div class="jelly-form">
                            <input name="submit" type="submit" value="Annuler" ng-click="autoDepart='';collapse=0;"/>
                            <input name="submit" type="submit" value="Sauvegarder" ng-click="trajet.path='mobil';$parent.param.trajet.push(trajet);autoDepart='';collapse=0;trajet={};$route.reload();addTrajet();"/>
							<input ng-hide="trajet.arrivee!='9'" name="submit" type="submit" value="Sauvegarder avec aussi le retour" style="width:98%" ng-click="trajet.path='mobil';trajet2.path='mobil';$parent.param.trajet.push(trajet);autoDepart='';collapse=0;trajet2={};trajet2.depart=trajet.arrivee;trajet2.arrivee=trajet.depart;$parent.param.trajet.push(trajet2);trajet={};trajet2={};$route.reload();"/>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>-->

	<div class="metacard" ng-controller="TrajetModif">
        <div class="">
            <div class="card front">
                        <div style="position: relative;"> 
							<paper-input floatinglabel label="Gare de départ :" placeholder="Gare de départ" ng-model="autoDepart"></paper-input>
                            <a style="position: absolute; cursor: pointer; font-size: 1em; top: 2px; right: 5px;" ng-show="autoShow" tabindex="-1" ng-click="autoDepart='';autoShow=0;" class="clear_button">×</a>
                        </div>
                    <div ng-show="autoShow">
                        <div class="autocomplete" ng-repeat="index in DepartList" ng-click="$parent.autoDepart = gare[index.codeTR3A];$parent.trajet.depart = '{{index.codeTR3A}}'; $parent.trajet.arrivee = '0';getDessertes(); $parent.trajet.depart_pos = {'latitude':'{{index.latitude}}','longitude':'{{index.longitude}}'}; trajet.savedate = '';broadcastRefresh();$parent.autoShow = 0;$parent.collapse=1">
                            <a>{{index.name}} <span><span ng-repeat="im in index.lignes" class="rer transilien ligne{{im.idLigne}}">{{im.idLigne}}</span></span></a>
                        </div>
                    </div>
                <div class="collapsible" ng-show="collapse">
                    <div ng-hide="autoShow">
                        <div>
                            <label>Arrivée :</label>
                            <div>
                                <SELECT ng-show="ListeDessertes" ng-model="trajet.arrivee" ng-change="trajet.savedate = '';broadcastRefresh()">
                                    <OPTION value='0' >Toutes directions</OPTION>
                                    <OPTION ng-repeat="index in ListeDessertes | orderBy:'name'" value="{{index.codeTR3A}}" ng-selected="index.codeTR3A==trajet.arrivee">{{gare[index.codeTR3A]}}</OPTION>
                                </SELECT>
                                <div ng-hide="ListeDessertes" ng-click="getDessertes();">
                                    <span class="svg refresh spin_image" style="height:18px;width:18px;">MaJ</span> {{gare[trajet.arrivee]}}
                                </div>
                            </div>
                        </div>
                        <div>
							<paper-button raisedButton label="Annuler" ng-click="autoDepart='';collapse=0;"></paper-button>
							<paper-button raisedButton label="Sauvegarder" ng-click="trajet.path='mobil';$parent.param.trajet.push(trajet);autoDepart='';collapse=0;trajet={};$route.reload();addTrajet();"></paper-button>
							<input ng-hide="trajet.arrivee!='9'" name="submit" type="submit" value="Sauvegarder avec aussi le retour" style="width:98%" ng-click="trajet.path='mobil';trajet2.path='mobil';$parent.param.trajet.push(trajet);autoDepart='';collapse=0;trajet2={};trajet2.depart=trajet.arrivee;trajet2.arrivee=trajet.depart;$parent.param.trajet.push(trajet2);trajet={};trajet2={};$route.reload();"/>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
	
<div class="metacard" ng-repeat="trajet in param.trajet | orderBy:'dist'" ng-controller="TrajetModif">
			<div class="">
				<div class="card front">
					<div class="title" ng-click="getDessertes();collapse = !collapse; " ng-swipe-left="rmTrajet(trajet);">
                        <span>
                            <span ng-show="collapse">&#9660;</span>
                            <span ng-hide="collapse">&#9654;</span>
                            {{gare[trajet.depart]}} vers {{gare[trajet.arrivee]}}
                        </span>
                        <!--<div class="corner_config" ng-click="collapse = !collapse">i</div>-->
                    </div>
				<div class="collapsible" ng-show="collapse">
					<div class="jelly-form">
						<label>Depart : </label>
						<div style="position: relative;">
							<input type="text" ng-model="autoDepart"  placeholder="{{gare[trajet.depart]}}" ng-change="getLocation()">
							<a style="position: absolute; cursor: pointer; font-size: 1em; top: 2px; right: 5px;" ng-show="autoShow" tabindex="-1" ng-click="autoDepart='';autoShow=0;" class="clear_button">×</a>
						</div>
					</div>
					<div ng-show="autoShow">
							<div class="autocomplete" ng-repeat="index in DepartList" ng-click="$parent.autoDepart = ''; trajet.depart = '{{index.codeTR3A}}'; getDessertes(); trajet.depart_pos = {'latitude':'{{index.latitude}}','longitude':'{{index.longitude}}'}; trajet.savedate = ''; $parent.autoShow = 0; broadcastRefresh();">
                                <a>{{index.name}} <span><span ng-repeat="im in index.lignes" class="rer transilien ligne{{im.idLigne}}">{{im.idLigne}}</span></span></a>
                            </div>
					</div>
					<div ng-hide="autoShow">
						<div class="jelly-form">
							<label>Arrivée :</label>
							<div>
								<SELECT ng-show="ListeDessertes" ng-model="trajet.arrivee" ng-change="trajet.savedate = '';broadcastRefresh()">
									<OPTION value='0' >Toutes directions</OPTION>
									<OPTION ng-repeat="index in ListeDessertes | orderBy:'name'" value="{{index.codeTR3A}}" ng-selected="index.codeTR3A==trajet.arrivee">{{gare[index.codeTR3A]}}</OPTION>
								</SELECT>
                                <div ng-hide="ListeDessertes" ng-click="getDessertes();">
                                    <span class="svg refresh spin_image" style="height:18px;width:18px;">MaJ</span> {{gare[trajet.arrivee]}}
                                </div>
							</div>
						</div>
						<div class="jelly-form">
							<input name="submit" type="submit" value="Supprimer trajet" ng-click="rmTrajet(trajet);"/>
							<input name="submit" type="submit" value="Terminé" ng-click="broadcastRefresh(); collapse = 'false'"/>
						</div>
					</div>
				</div>
				</div>
			</div>
			

			
	</div>
	
	   <!-- <div class="metacard" ng-show="debug">
            <div class="card front">
                    <div>Debug : {{debug}}</div>
					<div>Phonegap : {{phonegap}}</div>
					<div ng-click='gaPlugin.trackEvent(successHandler, errorHandler, "App", "Refresh", "App refreshed", 1);alert("OK");'>Test event</div>
					<div ng-click='$scope.gaPlugin.trackEvent(successHandler, errorHandler, "App", "Refresh", "App refreshed", 1);alert("OK");'>Test event</div>
					<div ng-click="gaPlugin.trackPage(successHandler, errorHandler, $scope.route);alert('OK');">Test page</div>
					<div ng-click="gaPlugin.trackPage(successHandler, errorHandler, route);alert('OK');">Test page2</div>
			</div>
		</div>
	

	<div ui-tree>
  <ol ui-tree-nodes="" ng-model="list">
    <li ng-repeat="trajet in param.trajet" ui-tree-node>
      <div ui-tree-handle>
        {{gare[trajet.depart]}} vers {{gare[trajet.arrivee]}}
      </div>
    </li>
  </ol>
</div> 
	<div ui-tree="trips">
	<ol ui-tree-nodes="trips" ng-model="list">
		<li ng-repeat="trajet in param.trajet" ui-tree-node="trips">
		<div class="card">
			{{gare[trajet.depart]}} vers {{gare[trajet.arrivee]}}
			<div ui-tree-handle>X</div>
		</div>
		</li>
	</ol>
	</div>
-->
</div>

<paper-toast id="Suppr" text="Trajet supprimé." class="capsule">
</paper-toast>

