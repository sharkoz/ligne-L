<ion-view title="Favoris">
  <ion-nav-bar class="bar-positive">
    <ion-nav-buttons side="left">
	<button class="button button-icon icon ion-navicon" menu-toggle="left"></button>
	</ion-nav-buttons>
	<ion-nav-buttons side="right">
		<a class="button button-icon icon ion-home" href="#/" ></a>
	</ion-nav-buttons>
  </ion-nav-bar>
<ion-content>
<div class="cardswidth" ng-cloak>
	<div class="metacard" ng-controller="TrajetModif">
        <div class="card-ligne front">
            <div style="position: relative;"> 
            	<a style="position: absolute; cursor: pointer; font-size: 1em; top: 2px; right: 5px;" tabindex="-1" ng-click="depart='';autoShow=0;" class="clear_button">×</a>
					<angucomplete id="autoDepart"
			          placeholder="Gare de départ"
			          pause="100"
			          selectedobject="trajet.depart"
			          localdata="gares"
			          searchfields="name"
			          titlefield="name"
			          minlength="1"
			          inputclass="form-control form-control-small"/>
            </div>
            <div class="collapsible" ng-show="trajet.depart">
                <div ng-hide="autoShow" class="">
                    <div class="item item-input item-select">
                        <div class="input-label">Arrivée :</div>
                            <SELECT ng-show="ListeDessertes" ng-model="trajet.arrivee" ng-change="trajet.savedate = '';broadcastRefresh()">
                                <OPTION value='0' >Toutes directions</OPTION>
                                <OPTION ng-repeat="index in ListeDessertes | orderBy:'name'" value="{{index.codeTR3A}}" ng-selected="index.codeTR3A==trajet.arrivee">{{gare[index.codeTR3A]}}</OPTION>
                            </SELECT>
                            <div ng-hide="ListeDessertes" ng-click="getDessertes();">
                                <span class="svg refresh spin_image" style="height:18px;width:18px;">MaJ</span> {{gare[trajet.arrivee]}}
                            </div>
                    </div>
					<div class="button-bar">
						<a class="button" ng-click="autoDepart='';">Annuler</a>
						<a class="button" ng-click="TrajetsService.AddTrajet(trajet.depart.originalObject.code, trajet.arrivee); autoDepart=''; trajet={}; $route.reload();">Sauvegarder</a>
					</div>
                    <div>
						<input ng-hide="trajet.arrivee!='9'" name="submit" type="submit" value="Sauvegarder avec aussi le retour" style="width:98%" ng-click=""/>
                    </div>
                </div>
            </div>
        </div>
    </div>
<div data-sortable="board.dragControlListeners" data-ng-model="param.trajet" >	
	<div class="card-ligne front" ng-repeat="trajet in favoris"  data-sortable-item ng-controller="TrajetModif">
				
					<div class="title" ng-click="getDessertes();collapse = !collapse; " ng-swipe-left="rmTrajet(trajet);">
                        <span>
                            <span ng-show="collapse" >&#9660;</span>
                            <span ng-hide="collapse" >&#9654;</span>
                            {{gare[trajet.depart]}} vers {{gare[trajet.arrivee]}} <span class="ion-arrow-move" data-sortable-item-handle style="vertical-align: text-top;float:right;">
                        </span>
                        <!--<div class="corner_config" ng-click="collapse = !collapse">i</div>-->
                    </div>
				<div class="collapsible" ng-show="collapse">
					<div class="item item-input" style="border-style:none;">
						<div class="input-label">Depart  : {{gare[trajet.depart]}}</div>
					</div>
					<div>
						<div class="item item-input item-select">
							<div class="input-label">Arrivée :</div>
								<SELECT ng-show="ListeDessertes" ng-model="trajet.arrivee" ng-change="trajet.savedate = '';broadcastRefresh()">
									<OPTION value='0' >Toutes directions</OPTION>
									<OPTION ng-repeat="index in ListeDessertes | orderBy:'name'" value="{{index.codeTR3A}}" ng-selected="index.codeTR3A==trajet.arrivee">{{gare[index.codeTR3A]}}</OPTION>
								</SELECT>
								<div ng-hide="ListeDessertes" ng-click="getDessertes();">
									<span class="svg refresh spin_image" style="height:18px;width:18px;">MaJ</span> {{gare[trajet.arrivee]}}
								</div>
						</div>
						<div class="button-bar">
							<a class="button" ng-click="rmTrajet(trajet);">Supprimer</a>
							<a class="button" ng-click="broadcastRefresh(); collapse = !collapse">Sauvegarder</a>
						</div>
						<!--<div class="jelly-form">
							<input name="submit" type="submit" value="Supprimer trajet" ng-click="rmTrajet(trajet);"/>
							<input name="submit" type="submit" value="Terminé" ng-click="broadcastRefresh(); collapse = 'false'"/>
						</div>-->
					</div>
				</div>
	</div>
</div>
	
	   <!-- <div class="metacard" ng-show="debug">
            <div class="card front">
                    <div>Debug : {{debug}}</div>
					<div>Phonegap : {{phonegap}}</div>
					<div ng-click='gaPlugin.trackEvent(successHandler, errorHandler, "App", "Refresh", "App refreshed", 1);alert("OK");'>Test event</div>
					<div ng-click='$scope.gaPlugin.trackEvent(successHandler, errorHandler, "App", "Refresh", "App refreshed", 1);alert("OK");'>Test event</div>
					<div ng-click="gaPlugin.trackPage(successHandler, errorHandler, $scope.route);alert('OK');">Test page</div>
					<div ng-click="gaPlugin.trackPage(successHandler, errorHandler, route);alert('OK');">Test page2</div>
			</div>
		</div>
-->
</div>

<paper-toast id="Suppr" text="Trajet supprimé." class="capsule">
</paper-toast>

</ion-content>
</ion-view>